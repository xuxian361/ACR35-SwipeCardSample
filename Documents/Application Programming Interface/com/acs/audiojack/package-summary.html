<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_76) on Fri Feb 27 16:48:56 CST 2015 -->
<title>com.acs.audiojack</title>
<meta name="date" content="2015-02-27">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="com.acs.audiojack";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../com/acs/audiojack/package-summary.html">Package</a></li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Package</li>
<li>Next Package</li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?com/acs/audiojack/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
<h1 title="Package" class="title">Package&nbsp;com.acs.audiojack</h1>
<div class="docSummary">
<div class="block">Provides classes and interfaces for communicating with ACS audio jack readers on
Android 2.0 (Eclair) or above.</div>
</div>
<p>See:&nbsp;<a href="#package_description">Description</a></p>
</div>
<div class="contentContainer">
<ul class="blockList">
<li class="blockList">
<table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Interface Summary table, listing interfaces, and an explanation">
<caption><span>Interface Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Interface</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/AudioJackReader.OnAuthCompleteListener.html" title="interface in com.acs.audiojack">AudioJackReader.OnAuthCompleteListener</a></td>
<td class="colLast">
<div class="block">Interface definition for a callback to be invoked when the reader
 authentication is complete.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/AudioJackReader.OnCustomIdAvailableListener.html" title="interface in com.acs.audiojack">AudioJackReader.OnCustomIdAvailableListener</a></td>
<td class="colLast">
<div class="block">Interface definition for a callback to be invoked when the reader sends
 the custom ID.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/AudioJackReader.OnDeviceIdAvailableListener.html" title="interface in com.acs.audiojack">AudioJackReader.OnDeviceIdAvailableListener</a></td>
<td class="colLast">
<div class="block">Interface definition for a callback to be invoked when the reader sends
 the device ID.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/AudioJackReader.OnDukptOptionAvailableListener.html" title="interface in com.acs.audiojack">AudioJackReader.OnDukptOptionAvailableListener</a></td>
<td class="colLast">
<div class="block">Interface definition for a callback to be invoked when the reader sends
 the DUKPT option.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/AudioJackReader.OnFirmwareVersionAvailableListener.html" title="interface in com.acs.audiojack">AudioJackReader.OnFirmwareVersionAvailableListener</a></td>
<td class="colLast">
<div class="block">Interface definition for a callback to be invoked when the reader sends
 the firmware version.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/AudioJackReader.OnPiccAtrAvailableListener.html" title="interface in com.acs.audiojack">AudioJackReader.OnPiccAtrAvailableListener</a></td>
<td class="colLast">
<div class="block">Interface definition for a callback to be invoked when the reader sends
 the ATR from PICC.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/AudioJackReader.OnPiccResponseApduAvailableListener.html" title="interface in com.acs.audiojack">AudioJackReader.OnPiccResponseApduAvailableListener</a></td>
<td class="colLast">
<div class="block">Interface definition for a callback to be invoked when the reader sends
 the response APDU from PICC.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/AudioJackReader.OnRawDataAvailableListener.html" title="interface in com.acs.audiojack">AudioJackReader.OnRawDataAvailableListener</a></td>
<td class="colLast">
<div class="block">Interface definition for a callback to be invoked when the reader sends
 the raw data.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/AudioJackReader.OnResetCompleteListener.html" title="interface in com.acs.audiojack">AudioJackReader.OnResetCompleteListener</a></td>
<td class="colLast">
<div class="block">Interface definition for a callback to be invoked when the reader reset
 is complete.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/AudioJackReader.OnResultAvailableListener.html" title="interface in com.acs.audiojack">AudioJackReader.OnResultAvailableListener</a></td>
<td class="colLast">
<div class="block">Interface definition for a callback to be invoked when the reader sends
 the result.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/AudioJackReader.OnStatusAvailableListener.html" title="interface in com.acs.audiojack">AudioJackReader.OnStatusAvailableListener</a></td>
<td class="colLast">
<div class="block">Interface definition for a callback to be invoked when the reader sends
 the status.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/AudioJackReader.OnTrackDataAvailableListener.html" title="interface in com.acs.audiojack">AudioJackReader.OnTrackDataAvailableListener</a></td>
<td class="colLast">
<div class="block">Interface definition for a callback to be invoked when the reader sends
 the track data.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/AudioJackReader.OnTrackDataNotificationListener.html" title="interface in com.acs.audiojack">AudioJackReader.OnTrackDataNotificationListener</a></td>
<td class="colLast">
<div class="block">Interface definition for a callback to be invoked when the reader
 notifies the track data.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/AudioJackReader.OnTrackDataOptionAvailableListener.html" title="interface in com.acs.audiojack">AudioJackReader.OnTrackDataOptionAvailableListener</a></td>
<td class="colLast">
<div class="block">Interface definition for a callback to be invoked when the reader sends
 the track data option.</div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Class Summary table, listing classes, and an explanation">
<caption><span>Class Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/AesTrackData.html" title="class in com.acs.audiojack">AesTrackData</a></td>
<td class="colLast">
<div class="block">The <code>AesTrackData</code> class represents the track data after swiping a
 card from the reader using AES mode.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/AudioJackReader.html" title="class in com.acs.audiojack">AudioJackReader</a></td>
<td class="colLast">
<div class="block">The <code>AudioJackReader</code> class represents ACS audio jack readers.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/CRC16.html" title="class in com.acs.audiojack">CRC16</a></td>
<td class="colLast">
<div class="block">The <code>CRC16</code> class is used to compute a CRC16 checksum from data
 provided as input value.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/DukptReceiver.html" title="class in com.acs.audiojack">DukptReceiver</a></td>
<td class="colLast">
<div class="block">The <code>DukptReceiver</code> class generates the future keys according to
 ANSI X9.24-1:2009.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/DukptTrackData.html" title="class in com.acs.audiojack">DukptTrackData</a></td>
<td class="colLast">
<div class="block">The <code>DukptTrackData</code> class represents the track data after swiping
 a card from the reader using DUKPT mode.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/Result.html" title="class in com.acs.audiojack">Result</a></td>
<td class="colLast">
<div class="block">The <code>Result</code> class represents the execution result after
 performing the operation from the reader.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/Status.html" title="class in com.acs.audiojack">Status</a></td>
<td class="colLast">
<div class="block">The <code>Status</code> class represents the status about the reader.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/Track1Data.html" title="class in com.acs.audiojack">Track1Data</a></td>
<td class="colLast">
<div class="block">The <code>Track1Data</code> class is used to decode the track 1 data into
 fields specified by ISO/IEC 7813.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/Track2Data.html" title="class in com.acs.audiojack">Track2Data</a></td>
<td class="colLast">
<div class="block">The <code>Track2Data</code> class is used to decode the track 2 data into
 fields specified by ISO/IEC 7813.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/TrackData.html" title="class in com.acs.audiojack">TrackData</a></td>
<td class="colLast">
<div class="block">The <code>TrackData</code> class represents the track data after swiping a
 card from the reader.</div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Exception Summary table, listing exceptions, and an explanation">
<caption><span>Exception Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Exception</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/CardTimeoutException.html" title="class in com.acs.audiojack">CardTimeoutException</a></td>
<td class="colLast">
<div class="block">Thrown when the card operation timed out.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/CommunicationErrorException.html" title="class in com.acs.audiojack">CommunicationErrorException</a></td>
<td class="colLast">
<div class="block">Thrown when there is an error occurred in the communication.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/CommunicationTimeoutException.html" title="class in com.acs.audiojack">CommunicationTimeoutException</a></td>
<td class="colLast">
<div class="block">Thrown when there is timeout in the communication.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/InvalidDeviceStateException.html" title="class in com.acs.audiojack">InvalidDeviceStateException</a></td>
<td class="colLast">
<div class="block">Thrown when the state of reader is invalid.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/ProtocolMismatchException.html" title="class in com.acs.audiojack">ProtocolMismatchException</a></td>
<td class="colLast">
<div class="block">Thrown when the requested protocols are incompatible with the protocol
 currently in use with the card.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/ReaderException.html" title="class in com.acs.audiojack">ReaderException</a></td>
<td class="colLast">
<div class="block"><code>ReaderException</code> is the superclass of those exceptions that can
 be thrown during normal operation of the reader.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/ReaderNotStartedException.html" title="class in com.acs.audiojack">ReaderNotStartedException</a></td>
<td class="colLast">
<div class="block">Thrown when the reader is not started.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/RemovedCardException.html" title="class in com.acs.audiojack">RemovedCardException</a></td>
<td class="colLast">
<div class="block">Thrown when a program attempts to access a card which is removed.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/RequestQueueFullException.html" title="class in com.acs.audiojack">RequestQueueFullException</a></td>
<td class="colLast">
<div class="block">Thrown when the request queue is full.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/UnresponsiveCardException.html" title="class in com.acs.audiojack">UnresponsiveCardException</a></td>
<td class="colLast">
<div class="block">Thrown when a program attempts to access a card which is not responding to a
 reset.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../com/acs/audiojack/UnsupportedCardException.html" title="class in com.acs.audiojack">UnsupportedCardException</a></td>
<td class="colLast">
<div class="block">Thrown when a program attempts to access a card which is not supported.</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<a name="package_description">
<!--   -->
</a>
<h2 title="Package com.acs.audiojack Description">Package com.acs.audiojack Description</h2>
<div class="block">Provides classes and interfaces for communicating with ACS audio jack readers on
Android 2.0 (Eclair) or above. Note that the reader uses the audio channels on
your Android device. Your application must allow the following permission in the
AndroidManifest.xml.

<pre>
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="..."
    android:versionCode="..."
    android:versionName="..." &gt;

    ...

    &lt;uses-permission android:name="android.permission.RECORD_AUDIO" /&gt;

    ...

&lt;/manifest&gt;
</pre>

To create and initialize a <a href="../../../com/acs/audiojack/AudioJackReader.html" title="class in com.acs.audiojack"><code>AudioJackReader</code></a> object, get
an instance of
<a href="http://developer.android.com/reference/android/media/AudioManager.html">
<code>AudioManager</code></a> by calling
<a href="http://developer.android.com/reference/android/content/Context.html#getSystemService(java.lang.String)">
<code>Context.getSystemService()</code></a> method.

<pre>
...

public class MainActivity extends Activity {

    ...

    private AudioManager mAudioManager;
    private AudioJackReader mReader;

    ...

    &#64;Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        ...

        mAudioManager = (AudioManager) getSystemService(Context.AUDIO_SERVICE);
        mReader = new AudioJackReader(mAudioManager);

        ...
    }

    ...
}

...
</pre>

<h3>Starting and stopping the reader</h3>

<p>
To start an instance of the <a href="../../../com/acs/audiojack/AudioJackReader.html" title="class in com.acs.audiojack"><code>AudioJackReader</code></a> object,
use the <a href="../../../com/acs/audiojack/AudioJackReader.html#start()"><code>start()</code></a> method. If
your application does not stop the reader properly, it will make other
applications cannot use the audio channels. To stop the instance of the
<a href="../../../com/acs/audiojack/AudioJackReader.html" title="class in com.acs.audiojack"><code>AudioJackReader</code></a> object, use the
<a href="../../../com/acs/audiojack/AudioJackReader.html#stop()"><code>stop()</code></a> method. The following
activity implements the required lifecycle methods.

<pre>
...

public class MainActivity extends Activity {

    ...

    &#64;Override
    protected void onStart() {
        super.onStart();
        mReader.start();
    }

    &#64;Override
    protected void onResume() {
        super.onResume();
        mReader.start();
    }

    &#64;Override
    protected void onPause() {
        super.onPause();
        mReader.stop();
    }

    &#64;Override
    protected void onStop() {
        super.onStop();
        mReader.stop();
    }

    ...
}

...
</pre>

<h3>Resetting the reader</h3>

<p>
The sleep mode of reader is enabled by default. To use the reader, your
application should call <a href="../../../com/acs/audiojack/AudioJackReader.html#reset()"><code>reset()</code></a>
method. If you register a callback using
<a href="../../../com/acs/audiojack/AudioJackReader.html#setOnResetCompleteListener(com.acs.audiojack.AudioJackReader.OnResetCompleteListener)"><code>setOnResetCompleteListener()</code></a> method, it will receive a notification after the
operation is completed.

<pre>
...

/* Reset the reader. */
mReader.reset();

...

/* Set the reset complete callback. */
mReader.setOnResetCompleteListener(
        new AudioJackReader.OnResetCompleteListener() {

    &#64;Override
    public void onResetComplete(AudioJackReader reader) {

        /* TODO: Add your code here to process the notification. */
        ...
    }
});

...
</pre>

<h3>Controlling the sleep mode</h3>

<p>
You can enable the sleep mode by calling
<a href="../../../com/acs/audiojack/AudioJackReader.html#sleep()"><code>sleep()</code></a> method. If you
register a callback using
<a href="../../../com/acs/audiojack/AudioJackReader.html#setOnResultAvailableListener(com.acs.audiojack.AudioJackReader.OnResultAvailableListener)"><code>setOnResultAvailableListener()</code></a> method, it will receive a notification after the
operation is completed.

<pre>
...

/* Enable the sleep mode. */
mReader.sleep();

...

/* Set the result callback. */
mReader.setOnResultAvailableListener(
        new AudioJackReader.OnResultAvailableListener() {

    &#64;Override
    public void onResultAvailable(AudioJackReader reader, Result result) {

        /* TODO: Add your code here to process the notification. */
        ...
    }
});

...
</pre>

<h3>Setting the sleep timeout</h3>

<p>
You can set the sleep timeout by calling
<a href="../../../com/acs/audiojack/AudioJackReader.html#setSleepTimeout(int)"><code>setSleepTimeout()</code></a>
method. If you register a callback using
<a href="../../../com/acs/audiojack/AudioJackReader.html#setOnResultAvailableListener(com.acs.audiojack.AudioJackReader.OnResultAvailableListener)"><code>setOnResultAvailableListener()</code></a> method, it will receive a notification after the
operation is completed.

<pre>
...

/* Set the sleep timeout to 10 seconds. */
mReader.setSleepTimeout(10);

...

/* Set the result callback. */
mReader.setOnResultAvailableListener(
        new AudioJackReader.OnResultAvailableListener() {

    &#64;Override
    public void onResultAvailable(AudioJackReader reader, Result result) {

        /* TODO: Add your code here to process the notification. */
        ...
    }
});

...
</pre>

<h3>Getting the firmware version</h3>

<p>
To get the firmware version, you need to register a callback using
<a href="../../../com/acs/audiojack/AudioJackReader.html#setOnFirmwareVersionAvailableListener(com.acs.audiojack.AudioJackReader.OnFirmwareVersionAvailableListener)"><code>setOnFirmwareVersionAvailableListener()</code></a> method and send a request using
<a href="../../../com/acs/audiojack/AudioJackReader.html#getFirmwareVersion()"><code>getFirmwareVersion()</code></a> method.

<pre>
...

/* Get the firmware version. */
mReader.getFirmwareVersion();

...

/* Set the firmware version callback. */
mReader.setOnFirmwareVersionAvailableListener(
        new AudioJackReader.OnFirmwareVersionAvailableListener() {

    &#64;Override
    public void onFirmwareVersionAvailable(AudioJackReader reader,
        String firmwareVersion) {

        /* TODO: Add your code here to process the firmware version. */
        ...
    }
});

...
</pre>

<h3>Getting the status</h3>

<p>
To get the status, you need to register a callback using
<a href="../../../com/acs/audiojack/AudioJackReader.html#setOnStatusAvailableListener(com.acs.audiojack.AudioJackReader.OnStatusAvailableListener)"><code>setOnStatusAvailableListener()</code></a> method and send a request using
<a href="../../../com/acs/audiojack/AudioJackReader.html#getStatus()"><code>getStatus()</code></a> method.

<pre>
...

/* Get the status. */
mReader.getStatus();

...

/* Set the status callback. */
mReader.setOnStatusAvailableListener(
        new AudioJackReader.OnStatusAvailableListener() {

    &#64;Override
    public void onStatusAvailable(AudioJackReader reader, Status status) {

        /* TODO: Add your code here to process the status. */
        ...
    }
});

...
</pre>

<h3>Receiving the track data</h3>

<p>
When you swipe a card, the reader notifies a track data and sends it through an
audio channel to your Android device. To receive the notification and the track
data, you need to register a callback using
<a href="../../../com/acs/audiojack/AudioJackReader.html#setOnTrackDataNotificationListener(com.acs.audiojack.AudioJackReader.OnTrackDataNotificationListener)"><code>setOnTrackDataNotificationListener()</code></a> and
<a href="../../../com/acs/audiojack/AudioJackReader.html#setOnTrackDataAvailableListener(com.acs.audiojack.AudioJackReader.OnTrackDataAvailableListener)"><code>setOnTrackDataAvailableListener()</code></a> method. You can check the track error using
<a href="../../../com/acs/audiojack/TrackData.html#getTrack1ErrorCode()"><code>TrackData.getTrack1ErrorCode()</code></a> and
<a href="../../../com/acs/audiojack/TrackData.html#getTrack2ErrorCode()"><code>TrackData.getTrack2ErrorCode()</code></a> methods. Note that
the received <a href="../../../com/acs/audiojack/TrackData.html" title="class in com.acs.audiojack"><code>TrackData</code></a> object will be the instance of
<a href="../../../com/acs/audiojack/AesTrackData.html" title="class in com.acs.audiojack"><code>AesTrackData</code></a> or
<a href="../../../com/acs/audiojack/DukptTrackData.html" title="class in com.acs.audiojack"><code>DukptTrackData</code></a> according to the settings. You must
check the type of instance before accessing the object.

<p>
You can get the track data using
<a href="../../../com/acs/audiojack/AesTrackData.html#getTrackData()"><code>AesTrackData.getTrackData()</code></a>,
<a href="../../../com/acs/audiojack/DukptTrackData.html#getTrack1Data()"><code>DukptTrackData.getTrack1Data()</code></a> and
<a href="../../../com/acs/audiojack/DukptTrackData.html#getTrack2Data()"><code>DukptTrackData.getTrack2Data()</code></a> methods. Note that the
track data of <a href="../../../com/acs/audiojack/AesTrackData.html" title="class in com.acs.audiojack"><code>AesTrackData</code></a> object is encrypted by AES
while the track data of <a href="../../../com/acs/audiojack/DukptTrackData.html" title="class in com.acs.audiojack"><code>DukptTrackData</code></a> object is
encrypted by Triple DES. You must decrypt it before accessing the original track
data.

<p>
After decrypting the track data of <a href="../../../com/acs/audiojack/AesTrackData.html" title="class in com.acs.audiojack"><code>AesTrackData</code></a>
object, you can use <a href="../../../com/acs/audiojack/Track1Data.html#fromByteArray(byte[])"><code>Track1Data.fromByteArray(byte[])</code></a>
and <a href="../../../com/acs/audiojack/Track2Data.html#fromByteArray(byte[])"><code>Track2Data.fromByteArray(byte[])</code></a> methods to decode
the track data into fields. For the track data or masked track data of
<a href="../../../com/acs/audiojack/DukptTrackData.html" title="class in com.acs.audiojack"><code>DukptTrackData</code></a> object, you can use
<a href="../../../com/acs/audiojack/Track1Data.html#fromString(java.lang.String)"><code>Track1Data.fromString(String)</code></a> and
<a href="../../../com/acs/audiojack/Track2Data.html#fromString(java.lang.String)"><code>Track2Data.fromString(String)</code></a> methods.

<pre>
...

/* Set the track data notification callback. */
mReader.setOnTrackDataNotificationListener(
    new AudioJackReader.OnTrackDataNotificationListener() {

    &#64;Override
    public void onTrackDataNotification(AudioJackReader reader) {

        /* TODO: Add your code here to process the notification. */
        ...
    }
});

...

/* Set the track data callback. */
mReader.setOnTrackDataAvailableListener(
        new AudioJackReader.OnTrackDataAvailableListener() {

    &#64;Override
    public void onTrackDataAvailable(AudioJackReader reader,
            TrackData trackData) {

        /* TODO: Add your code here to process the track data. */
        if ((trackData.getTrack1ErrorCode() != TrackData.TRACK_ERROR_SUCCESS)
                || (trackData.getTrack2ErrorCode() != TrackData.TRACK_ERROR_SUCCESS)) {

            /* Show the track error. */
            ...

            return;
        }

        if (trackData instanceof AesTrackData) {

            AesTrackData aesTrackData = (AesTrackData) trackData;

            ...

        } else if (trackData instanceof DukptTrackData) {

            DukptTrackData dukptTrackData = (DukptTrackData) trackData;

            ...
        }

        ...
    }
});

...
</pre>

<h3>Receiving the raw data</h3>

<p>
If you want to access a raw data of a response, you can register a callback
using <a href="../../../com/acs/audiojack/AudioJackReader.html#setOnRawDataAvailableListener(com.acs.audiojack.AudioJackReader.OnRawDataAvailableListener)"><code>setOnRawDataAvailableListener()</code></a> method. Note that the raw data is not verified
by CRC16 checksum.

<pre>
...

/* Set the raw data callback. */
mReader.setOnRawDataAvailableListener(
        new AudioJackReader.OnRawDataAvailableListener() {

    &#64;Override
    public void onRawDataAvailable(AudioJackReader reader, byte[] rawData) {

        /* TODO: Add your code here to process the raw data. */
        ...
    }
});

...
</pre>

<h3>Working with the ICC</h3>

<p>
If your reader came with the ICC interface, you can operate the card using the
following methods:

<ul>
<li><a href="../../../com/acs/audiojack/AudioJackReader.html#power(int,%20int,%20int)"><code>power()</code></a></li>
<li><a href="../../../com/acs/audiojack/AudioJackReader.html#setProtocol(int,%20int,%20int)"><code>setProtocol()</code></a></li>
<li><a href="../../../com/acs/audiojack/AudioJackReader.html#transmit(int,%20byte[],%20int)"><code>transmit()</code></a></li>
<li><a href="../../../com/acs/audiojack/AudioJackReader.html#control(int,%20int,%20byte[],%20int)"><code>control()</code></a></li>
<li><a href="../../../com/acs/audiojack/AudioJackReader.html#updateCardState(int,%20int)"><code>updateCardState()</code></a></li>
<li><a href="../../../com/acs/audiojack/AudioJackReader.html#getAtr(int)"><code>getAtr()</code></a></li>
<li><a href="../../../com/acs/audiojack/AudioJackReader.html#getCardState(int)"><code>getCardState()</code></a></li>
<li><a href="../../../com/acs/audiojack/AudioJackReader.html#getProtocol(int)"><code>getProtocol()</code></a></li>
</ul>

<p>
Before transmitting the APDU, you need to reset the card using
<a href="../../../com/acs/audiojack/AudioJackReader.html#power(int,%20int,%20int)"><code>power()</code></a> method.
The ATR string will be returned if the card is operated normally. Otherwise, it
will throw <a href="../../../com/acs/audiojack/ReaderException.html" title="class in com.acs.audiojack"><code>ReaderException</code></a> to indicate the error.

<p>
After resetting the card, the card state is changed to
<a href="../../../com/acs/audiojack/AudioJackReader.html#CARD_NEGOTIABLE"><code>CARD_NEGOTIABLE</code></a> or
<a href="../../../com/acs/audiojack/AudioJackReader.html#CARD_SPECIFIC"><code>CARD_SPECIFIC</code></a>. You
cannot transmit the APDU if the card state is not equal to
<a href="../../../com/acs/audiojack/AudioJackReader.html#CARD_SPECIFIC"><code>CARD_SPECIFIC</code></a>. To select
the protocol, invoke
<a href="../../../com/acs/audiojack/AudioJackReader.html#setProtocol(int,%20int,%20int)"><code>setProtocol()</code></a> method with the preferred protocols.

<p>
After selecting the protocol, you can transmit the command APDU using
<a href="../../../com/acs/audiojack/AudioJackReader.html#transmit(int,%20byte[],%20int)"><code>transmit()</code></a> method.

<pre>
...

int slotNum = 0;
int action = AudioJackReader.CARD_WARM_RESET;
int timeout = 10 * 1000;    /* 10 seconds. */
byte[] atr = null;

int preferredProtocols = AudioJackReader.PROTOCOL_T0
        | AudioJackReader.PROTOCOL_T1;
int activeProtocol = 0;

byte[] commandApdu = { 0x00, (byte) 0x84, 0x00, 0x00, 0x08 };
byte[] responseApdu = null;

...

try {

    /* Reset the card. */
    atr = mReader.power(slotNum, action, timeout);
    if (atr != null) {

        /* Set the protocol. */
        activeProtocol = mReader.setProtocol(slotNum, preferredProtocols,
                timeout);

        /* Transmit the APDU. */
        responseApdu = mReader.transmit(slotNum, commandApdu, timeout);
    }

} catch (ReaderException e) {

    e.printStackTrace();
}

...
</pre>

<p>
You can transmit the control command to the reader using
<a href="../../../com/acs/audiojack/AudioJackReader.html#control(int,%20int,%20byte[],%20int)"><code>control()</code></a> method if the reader supports a set of escape commands.

<pre>
...

int controlCode = AudioJackReader.IOCTL_CCID_ESCAPE;
byte[] controlCommand = { (byte) 0xE0, 0x00, 0x00, 0x18, 0x00 };
byte[] controlResponse = null;

...

try {

    /* Transmit the control command. */
    controlResponse = mReader.control(slotNum, controlCode, controlCommand,
            timeout);

} catch (ReaderException e) {

    e.printStackTrace();
}

...
</pre>

<h3>Working with the PICC</h3>

<p>
If your reader came with the PICC interface, you can operate the card using the
following methods:

<ul>
<li><a href="../../../com/acs/audiojack/AudioJackReader.html#piccPowerOn(int,%20int)"><code>piccPowerOn()</code></a></li>
<li><a href="../../../com/acs/audiojack/AudioJackReader.html#piccTransmit(int,%20byte[])"><code>piccTransmit()</code></a></li>
<li><a href="../../../com/acs/audiojack/AudioJackReader.html#piccPowerOff()"><code>piccPowerOff()</code></a></li>
</ul>

<p>
Before transmitting the APDU, you need to power on the card using
<a href="../../../com/acs/audiojack/AudioJackReader.html#piccPowerOn(int,%20int)"><code>piccPowerOn()</code></a>
method. If you register a callback using
<a href="../../../com/acs/audiojack/AudioJackReader.html#setOnPiccAtrAvailableListener(com.acs.audiojack.AudioJackReader.OnPiccAtrAvailableListener)"><code>setOnPiccAtrAvailableListener()</code></a> method, you can receive the ATR string from the
card.

<p>
To transmit the APDU, you can use
<a href="../../../com/acs/audiojack/AudioJackReader.html#piccTransmit(int,%20byte[])"><code>piccTransmit()</code></a> method. If you register a callback using
<a href="../../../com/acs/audiojack/AudioJackReader.html#setOnPiccResponseApduAvailableListener(com.acs.audiojack.AudioJackReader.OnPiccResponseApduAvailableListener)"><code>setOnPiccResponseApduAvailableListener()</code></a> method, you can receive the response
APDU from the card.

<p>
After using the card, you can power off the card using
<a href="../../../com/acs/audiojack/AudioJackReader.html#piccPowerOff()"><code>piccPowerOff()</code></a> method.
If you register a callback using
<a href="../../../com/acs/audiojack/AudioJackReader.html#setOnResultAvailableListener(com.acs.audiojack.AudioJackReader.OnResultAvailableListener)"><code>setOnResultAvailableListener()</code></a> method, it will receive a notification after the
operation is completed.

<pre>
...

int timeout = 1;    /* 1 second. */
int cardType = PICC_CARD_TYPE_ISO14443_TYPE_A
        | PICC_CARD_TYPE_ISO14443_TYPE_B
        | PICC_CARD_TYPE_FELICA_212KBPS
        | PICC_CARD_TYPE_FELICA_424KBPS
        | PICC_CARD_TYPE_AUTO_RATS;
byte[] apdu = { 0x00, (byte) 0x84, 0x00, 0x00, 0x08 };

...

/* Power on the PICC. */
mReader.piccPowerOn(timeout, cardType);

...

/* Transmit the APDU. */
mReader.piccTransmit(timeout, apdu);

...

/* Power off the PICC. */
mReader.piccPowerOff();

...

/* Set the PICC ATR callback. */
mReader.setOnPiccAtrAvailableListener(
        new AudioJackReader.OnPiccAtrAvailableListener() {

    &#64;Override
    public void onPiccAtrAvailable(AudioJackReader reader, byte[] atr) {

        /* TODO: Add your code here to process the ATR. */
        ...
    }
});

/* Set the PICC response APDU callback. */
mReader.setOnPiccResponseApduAvailableListener(
        new AudioJackReader.OnPiccResponseApduAvailableListener() {

    &#64;Override
    public void onPiccResponseApduAvailable(AudioJackReader reader,
        byte[] responseApdu) {

        /* TODO: Add your code here to process the response APDU. */
        ...
    }
});

/* Set the result callback. */
mReader.setOnResultAvailableListener(
        new AudioJackReader.OnResultAvailableListener() {

    &#64;Override
    public void onResultAvailable(AudioJackReader reader, Result result) {

        /* TODO: Add your code here to process the notification. */
        ...
    }
});

...
</pre></div>
<dl><dt><span class="strong">Since:</span></dt>
  <dd>1.0</dd></dl>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../com/acs/audiojack/package-summary.html">Package</a></li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Package</li>
<li>Next Package</li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?com/acs/audiojack/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small><font size=-1>Copyright &copy; 2013-2015 Advanced Card Systems Ltd. All Rights Reserved.</font></small></p>
</body>
</html>
